<div class="recordPage">

  <h1>Clubs</h1>

  <div class="recordTable">
    <table class="table table-sm table-striped table-bordered table-hover">
      <thead>
        <tr>
        <td>Name</td>
        <td>Intials</td>
        <td>User Type</td>
        <td>Membership</td>
        </tr>
      </thead>
    <tbody id="tableBody">
  	<% @clubs.each do |club| %>
      <% @clubUser = current_user.club_users.find_by(club: club) %> 
	    <tr> 

  	  <td><%= club.name %></td> 
  	  <td><%= club.initials %></td>
      <td><%= @clubUser.utype.capitalize %></td>
      <td><%= 
        begin
          @clubUser.membership.name
        rescue NoMethodError => e
          'None'
        end 
      %></td>

      <% if @clubUser.utype != 'admin' %>
      <td>
        <%= form_for(:club_user, url: '/clubusers/leave') do |f| %> 
        <%= f.hidden_field :id, value: @clubUser.id %>
        <%= f.hidden_field :club, value: club.name %>
        <%= f.submit "Leave", class: "btn" %>
        <% end %>
      </td>
      <% end %>
      
      <td>
        <% if current_club.id != club.id %>
          <%= form_for(:clubs, url: '/clubs/user') do |f| %> 
          <%= f.hidden_field :id, value: club.id %>
          <%= f.submit "Select", class: "btn" %>
          <% end %>
        <% else %>
          Current Club
        <% end %>
      </td>

      </tr> 
    <% end %>
    </tbody>
  </table>

  <%= link_to "Add Club", '/clubs/add'%>
  

  </div>
</div>